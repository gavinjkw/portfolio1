!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("@angular/core")):"function"==typeof define&&define.amd?define("ngx-page-scroll-core",["exports","@angular/core"],t):t((e=e||self)["ngx-page-scroll-core"]={},e.ng.core)}(this,function(e,t){"use strict";var n=function(){return(n=Object.assign||function(e){for(var t,n=1,o=arguments.length;n<o;n++)for(var r in t=arguments[n])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)},o=function(){function e(e){this.startScrollPosition=0,this.interruptListenersAttached=!1,this.timer=null,e.scrollViews&&0!==e.scrollViews.length?this.isInlineScrolling=!0:(e.scrollViews=[e.document.documentElement,e.document.body,e.document.body.parentNode],this.isInlineScrolling=!1),this.pageScrollOptions=e}return e.getScrollingTargetPosition=function(e,t){var n=e.document.body,o=e.document.documentElement,r=e.document.defaultView&&e.document.defaultView.pageYOffset||undefined,i=e.document.defaultView&&e.document.defaultView.pageXOffset||undefined,l=r||o.scrollTop||n.scrollTop,s=i||o.scrollLeft||n.scrollLeft,c=o.clientTop||n.clientTop||0,a=o.clientLeft||n.clientLeft||0;if(t===undefined||null===t)return{top:l,left:s};var p=t.getBoundingClientRect(),u=p.top+l-c,g=p.left+s-a;return{top:Math.round(u),left:Math.round(g)}},e.getInlineScrollingTargetPosition=function(e,t){var n={top:t.offsetTop,left:t.offsetLeft};if(e.advancedInlineOffsetCalculation&&1===e.scrollViews.length){for(var o={top:0,left:0},r=t.ownerDocument.defaultView,i=!1,l=t.parentElement;!i&&l!==undefined&&null!==l;)"relative"===r.getComputedStyle(l).getPropertyValue("position")&&(o.top+=l.offsetTop,o.left+=l.offsetLeft),i=(l=l.parentElement)===e.scrollViews[0];i&&(n.top+=o.top,n.left+=o.left)}return n},e.prototype.getScrollPropertyValue=function(e){return this.pageScrollOptions.verticalScrolling?e.scrollTop:e.scrollLeft},e.prototype.extractScrollTargetPosition=function(){var t=this.getScrollTargetElement();return null===t||t===undefined?{top:NaN,left:NaN}:this.isInlineScrolling?e.getInlineScrollingTargetPosition(this.pageScrollOptions,t):e.getScrollingTargetPosition(this.pageScrollOptions,t)},e.prototype.getCurrentOffset=function(){return this.pageScrollOptions.scrollOffset},e.prototype.setScrollPosition=function(e){var t=this;return this.pageScrollOptions.scrollViews.reduce(function(n,o){var r=t.getScrollPropertyValue(o);if(o&&r!==undefined&&null!==r){var i=Math.abs(r-e),l=i<t.pageScrollOptions._minScrollDistance;if(t.pageScrollOptions.verticalScrolling?o.scrollTop=e:o.scrollLeft=e,l||i>Math.abs(t.getScrollPropertyValue(o)-e))return!0}return n},!1)},e.prototype.fireEvent=function(e){this.pageScrollOptions.scrollFinishListener&&this.pageScrollOptions.scrollFinishListener.emit(e)},e.prototype.attachInterruptListeners=function(e){var t=this;this.interruptListenersAttached&&this.detachInterruptListeners(),this.interruptListener=function(n){e.report(n,t)},this.pageScrollOptions.interruptEvents.forEach(function(e){return t.pageScrollOptions.document.body.addEventListener(e,t.interruptListener)}),this.interruptListenersAttached=!0},e.prototype.detachInterruptListeners=function(){var e=this;this.pageScrollOptions.interruptEvents.forEach(function(t){return e.pageScrollOptions.document.body.removeEventListener(t,e.interruptListener)}),this.interruptListenersAttached=!1},e.prototype.getScrollTargetElement=function(){if("string"==typeof this.pageScrollOptions.scrollTarget){var e=this.pageScrollOptions.scrollTarget;return null!==e.match(/^#[^\s]+$/g)?this.pageScrollOptions.document.getElementById(e.substr(1)):this.pageScrollOptions.document.querySelector(e)}return this.pageScrollOptions.scrollTarget},e}(),r=new t.InjectionToken("ngxps_config"),i={_interval:10,_minScrollDistance:2,_logLevel:1,namespace:"default",verticalScrolling:!0,duration:1250,scrollOffset:0,advancedInlineOffsetCalculation:!1,interruptEvents:["mousedown","wheel","DOMMouseScroll","mousewheel","keyup","touchmove"],interruptKeys:[" ","Escape","Tab","Enter","PageUp","PageDown","Home","End","ArrowUp","ArrowRight","ArrowLeft","ArrowDown"],interruptible:!0,easingLogic:function(e,t,n,o){return n*e/o+t}},l=function(){function e(o){var r=this;this.runningInstances=[],this.onInterrupted={report:function(e,t){if(t.pageScrollOptions.interruptible){var n=!0;"keyup"===e.type?-1===r.config.interruptKeys.indexOf(e.key)&&(n=!1):"mousedown"===e.type&&(t.pageScrollOptions.scrollViews.some(function(t){return t.contains(e.target)})||(n=!1)),n&&r.stopAll(t.pageScrollOptions.namespace)}}},this.config=n({},i,o),e.instanceCounter>0&&(this.config._logLevel>=2||this.config._logLevel>=1&&t.isDevMode())&&console.warn("An instance of PageScrollService already exists, usually including one provider should be enough, so double check."),e.instanceCounter++}return e.prototype.stopInternal=function(e,t){var n=this.runningInstances.indexOf(t);return n>=0&&this.runningInstances.splice(n,1),t.interruptListenersAttached&&t.detachInterruptListeners(),!!t.timer&&(clearInterval(t.timer),t.timer=undefined,t.fireEvent(!e),!0)},e.prototype.create=function(e){return new o(n({},this.config,e))},e.prototype.start=function(e){var o=this;if(e.pageScrollOptions=n({},this.config,e.pageScrollOptions),this.stopAll(e.pageScrollOptions.namespace),null!==e.pageScrollOptions.scrollViews&&0!==e.pageScrollOptions.scrollViews.length){var r=!1;e.startScrollPosition=0,e.pageScrollOptions.scrollViews.forEach(function(t){if(t!==undefined&&null!==t){var n=e.getScrollPropertyValue(t);!r&&n&&(e.startScrollPosition=n,r=!0)}});var i=e.getCurrentOffset(),l=e.extractScrollTargetPosition();if(e.targetScrollPosition=Math.round((e.pageScrollOptions.verticalScrolling?l.top:l.left)-i),e.distanceToScroll=e.targetScrollPosition-e.startScrollPosition,isNaN(e.distanceToScroll))return(this.config._logLevel>=2||this.config._logLevel>=1&&t.isDevMode())&&console.log("Scrolling not possible, as we can't find the specified target"),void e.fireEvent(!1);var s=Math.abs(e.distanceToScroll)<e.pageScrollOptions._minScrollDistance;e.executionDuration=e.pageScrollOptions.duration,e.pageScrollOptions.speed===undefined||null===e.pageScrollOptions.speed||e.pageScrollOptions.duration!==undefined&&null!==e.pageScrollOptions.duration||(e.executionDuration=Math.abs(e.distanceToScroll)/e.pageScrollOptions.speed*1e3);var c=e.executionDuration<=e.pageScrollOptions._interval;if(s||c)return(this.config._logLevel>=2||this.config._logLevel>=1&&t.isDevMode())&&(s?console.log("Scrolling not possible, as we can't get any closer to the destination"):console.log("Scroll duration shorter that interval length, jumping to target")),e.setScrollPosition(e.targetScrollPosition),void e.fireEvent(!0);e.pageScrollOptions.interruptible&&e.attachInterruptListeners(this.onInterrupted),e.startTime=(new Date).getTime(),e.endTime=e.startTime+e.executionDuration,e.timer=setInterval(function(e){var n,r=(new Date).getTime(),i=!1;e.endTime<=r?(n=e.targetScrollPosition,i=!0):n=Math.round(e.pageScrollOptions.easingLogic(r-e.startTime,e.startScrollPosition,e.distanceToScroll,e.executionDuration)),o.config._logLevel>=5&&t.isDevMode()&&console.warn("Scroll Position: "+n),e.setScrollPosition(n)||(i=!0),i&&o.stopInternal(!1,e)},this.config._interval,e),this.runningInstances.push(e)}else(this.config._logLevel>=2||this.config._logLevel>=1&&t.isDevMode())&&console.warn("No scrollViews specified, thus ngx-page-scroll does not know which DOM elements to scroll")},e.prototype.scroll=function(e){this.start(this.create(e))},e.prototype.stopAll=function(e){if(this.runningInstances.length>0){for(var t=!1,n=0;n<this.runningInstances.length;++n){var o=this.runningInstances[n];e&&o.pageScrollOptions.namespace!==e||(t=!0,this.stopInternal(!0,o),n--)}return t}return!1},e.prototype.stop=function(e){return this.stopInternal(!0,e)},e.instanceCounter=0,e.decorators=[{type:t.Injectable,args:[{providedIn:"root"}]}],e.ctorParameters=function(){return[{type:undefined,decorators:[{type:t.Inject,args:[r]}]}]},e.ngInjectableDef=t.ɵɵdefineInjectable({factory:function(){return new e(t.ɵɵinject(r))},token:e,providedIn:"root"}),e}(),s={},c=function(){function e(){}return e.forRoot=function(t){return{ngModule:e,providers:[l,{provide:r,useValue:t}]}},e.decorators=[{type:t.NgModule,args:[{providers:[l,{provide:r,useValue:s}]}]}],e}();e.NGXPS_CONFIG=r,e.NgxPageScrollCoreModule=c,e.PageScrollInstance=o,e.PageScrollService=l,e.defaultPageScrollConfig=i,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=ngx-page-scroll-core.umd.min.js.map